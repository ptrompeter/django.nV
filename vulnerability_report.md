

Vulnerability - 1 injection:

The file upload function in taskManager.views.py loads direct user input from the filename field into the (name) field in the function.  This allows us to make a SQL injection attack by adding a ' to our filename and adding an SQL query after it.  We did that and requested the admin password from auth_users.  When we clicked on the file we uploaded we got an error that showed the hashed password of the admin user.  This password is weak enough to be cracked if it was worth the trouble.

Repair: We used an object relation manager to clean the data before allowing it to be passed on to the database.

Vulnerability - 2 crummy auth:

The registration form in forms.py uses exclude rather than fields, and someone forgot to exclude some pretty important fields.  We added imput lines to the form by modifying the html and added superuser and staff permissions to our guy.  And then we made some more groups after accessing the admin panel.  

Repair: We can fix this by switching the excludes to friendly whitelisted fields.

Vulnerability - 3 XSS:

The |safe method used to display / update the username in the site's forms accept javascript as a valid entry, and will execute when the name is displayed.  We changed our login name to an alert.  One could also change it to a redirect with hilarious/disturbing consequences.

Repair: remove |safe from the forms that accept them.

Vulnerability - 4 Insecure Direct Object References:

There are tons of places in the code where one can directly access objects via the url without being properly authenticated.  For instance, the delete button on a user's task page: we logged in as user A and took note of a task that user was assigned.  In our case it was /taskManager/2/6.  We then logged in as user B and modified the HTML to direct the delete button away from the task it was assigned to and to /taskManager/2/task_delete/6.  When we clicked the button, we weren't able to see the redirected page, but the task was deleted - we confirmed by logging back in as user A.

Repair: Add authentication to views that receive form input that ensures that a user can only perform actions related to objects they own.  Make sure object.user == request.user, etc.

Vulnerability - 5 Misconfiguration:

Wow.  It turns out leaving debug=True SUCKS.  We tossed some junk characters on to the end of a url to see the debug page, which gave us a list of urls that were at least potentially accessible.  We chose taskManager/settings, and got a report that showed, amongst other things, all of the environmental variables on my actual, physical machine.  Which would SUCK irl.  We were also able to use taskManager/profile_view/(num) to look at profiles we weren't authorized to see.  So, that's bad.  And we discovered it because of Debug = True.

Repair: Set Debug = False for your production deployments.  Seriously. 

Vulnerability - 6 Exposure:

This site uses old, crummy, cracked encryption: MD5.  These passwords are crackable if someone really really want to - and because of the other vulnerabilities on the site (see A1, above), the poorly-hashed user passwords are discoverable.

Repair: Use modern encryption for all sensitive data.

Vulnerability - 7 Access:

Function-level authentication is very important, especially with a framework like django that doesn't have built-in support for object-level authentication.  We already discovered this vulnerability and exploited it in A5, above, and see the profiles of other users.

Repair: Add function level authentication to all view functions.
